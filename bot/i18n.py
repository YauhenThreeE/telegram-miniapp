from __future__ import annotations

from typing import Any

translations: dict[str, dict[str, str]] = {
    "en": {
        "welcome": "Welcome to your AI dietitian! Let's set up your profile.",
        "choose_language": "Choose your language",
        "language_selected": "Language saved: {language}",
        "ask_sex": "What is your sex?",
        "ask_date_of_birth": "Your date of birth (DD.MM.YYYY or YYYY-MM-DD)",
        "ask_height": "Your height in cm",
        "ask_weight": "Your current weight in kg",
        "ask_goal_weight": "Your goal weight in kg (or tap Skip)",
        "ask_gi_diagnoses": "GI diagnoses (IBS, GERD, etc.) or 'None'",
        "ask_other_diagnoses": "Other diagnoses or 'None'",
        "ask_medications": "Medications you take or 'None'",
        "ask_allergies": "Allergies/intolerances or 'None'",
        "ask_activity_level": "Activity level",
        "ask_nutrition_goal": "Main nutrition goal",
        "profile_saved": "Profile saved!",
        "profile_title": "Your profile",
        "profile_field_sex": "Sex",
        "profile_field_dob": "Date of birth",
        "profile_field_height": "Height (cm)",
        "profile_field_weight": "Current weight (kg)",
        "profile_field_goal_weight": "Goal weight (kg)",
        "profile_field_gi_diagnoses": "GI diagnoses",
        "profile_field_other_diagnoses": "Other diagnoses",
        "profile_field_medications": "Medications",
        "profile_field_allergies": "Allergies / intolerances",
        "profile_field_activity_level": "Activity level",
        "profile_field_nutrition_goal": "Nutrition goal",
        "profile_edit_prompt": "Select what you want to edit:",
        "menu_main": "Main menu",
        "not_implemented": "This feature is not implemented yet in this version.",
        "btn_log_meal": "Log meal (stub)",
        "btn_photo_meal": "Photo meal (stub)",
        "btn_water": "Water (stub)",
        "btn_weight": "Weight (stub)",
        "btn_stats": "Stats (stub)",
        "btn_fridge": "Fridge (stub)",
        "btn_budget": "Budget (stub)",
        "btn_recipes": "My recipes (stub)",
        "btn_ask": "Ask dietitian (stub)",
        "btn_profile": "/profile",
        "sex_m": "Male",
        "sex_f": "Female",
        "sex_other": "Other",
        "activity_low": "Low",
        "activity_medium": "Medium",
        "activity_high": "High",
        "goal_weight_loss": "Weight loss",
        "goal_maintenance": "Maintenance",
        "goal_weight_gain": "Weight gain",
        "goal_symptom_control": "Symptom control",
        "invalid_date": "Couldn't understand the date, please use DD.MM.YYYY or YYYY-MM-DD",
        "invalid_number": "Please enter a valid number.",
        "skip": "Skip",
        "profile_missing": "Profile not found. Please run /start first.",
        "updated": "Updated!",
        "menu_log_meal": "Log meal",
        "menu_photo_meal": "Photo meal",
        "menu_water": "Water",
        "menu_weight": "Weight",
        "menu_stats": "Stats",
        "ask_meal_type": "Choose meal type:",
        "meal_type_breakfast": "Breakfast",
        "meal_type_lunch": "Lunch",
        "meal_type_dinner": "Dinner",
        "meal_type_snack": "Snack",
        "ask_meal_text": "Describe what you ate (in free text).",
        "ask_meal_photo": "Send me a photo of your meal.",
        "ask_meal_photo_optional_text": "If you want, you can also add a short text description.",
        "meal_saved": "Meal saved.",
        "meal_photo_received": "Photo received. Estimating calories...",
        "meal_photo_saved": "Meal from photo saved.",
        "meal_summary": "Estimated: {calories} kcal (P {protein} g / F {fat} g / C {carbs} g).",
        "meal_photo_summary": "Estimated from photo: {calories} kcal (P {protein} g / F {fat} g / C {carbs} g).",
        "stats_today_title": "Today’s stats:",
        "stats_today_no_meals": "No meals logged today.",
        "stats_today_line": "Total: {calories} kcal (P {protein} g / F {fat} g / C {carbs} g).",
        "stats_today_macros_title": "Macros for today:",
        "stats_today_water_line": "Water: {ml} ml",
        "stats_last_weight_line": "Last weight: {weight} kg on {date}.",
        "stats_error": "Error while calculating stats. Please try again later.",
        "error_no_photo": "I did not find a photo in your message. Please send a picture of your meal.",
        "error_photo_processing": "Error while processing the photo. Please try again.",
        "ask_water_amount": "How much water did you drink? (in ml)",
        "water_preset_200": "200 ml",
        "water_preset_250": "250 ml",
        "water_preset_300": "300 ml",
        "water_preset_500": "500 ml",
        "water_other_amount": "Other amount",
        "water_saved": "Water intake saved.",
        "water_today_total": "Today you have drunk {ml} ml of water.",
        "water_invalid_amount": "Please enter a valid amount in milliliters.",
        "ask_weight": "Enter your current weight in kg (e.g. 72.5):",
        "weight_saved": "Weight saved.",
        "weight_no_previous": "This is your first recorded weight.",
        "weight_change_since_last": "Change since last entry: {delta} kg.",
        "weight_change_vs_goal": "Difference vs goal: {delta} kg.",
        "weight_invalid": "Please enter a valid weight in kg.",
        "unknown_command": "I don’t understand this command.",
    },
    "ru": {
        "welcome": "Добро пожаловать к вашему ИИ-диетологу! Давайте настроим профиль.",
        "choose_language": "Выберите язык",
        "language_selected": "Язык сохранён: {language}",
        "ask_sex": "Укажите ваш пол",
        "ask_date_of_birth": "Дата рождения (ДД.ММ.ГГГГ или ГГГГ-ММ-ДД)",
        "ask_height": "Ваш рост в см",
        "ask_weight": "Ваш текущий вес в кг",
        "ask_goal_weight": "Ваш целевой вес в кг (или нажмите Пропустить)",
        "ask_gi_diagnoses": "Проблемы ЖКТ (СРК, ГЭРБ и т.п.) или 'Нет'",
        "ask_other_diagnoses": "Другие диагнозы или 'Нет'",
        "ask_medications": "Принимаемые лекарства или 'Нет'",
        "ask_allergies": "Аллергии/непереносимости или 'Нет'",
        "ask_activity_level": "Уровень активности",
        "ask_nutrition_goal": "Главная цель питания",
        "profile_saved": "Профиль сохранён!",
        "profile_title": "Ваш профиль",
        "profile_field_sex": "Пол",
        "profile_field_dob": "Дата рождения",
        "profile_field_height": "Рост (см)",
        "profile_field_weight": "Текущий вес (кг)",
        "profile_field_goal_weight": "Целевой вес (кг)",
        "profile_field_gi_diagnoses": "Диагнозы ЖКТ",
        "profile_field_other_diagnoses": "Другие диагнозы",
        "profile_field_medications": "Лекарства",
        "profile_field_allergies": "Аллергии / непереносимости",
        "profile_field_activity_level": "Активность",
        "profile_field_nutrition_goal": "Цель питания",
        "profile_edit_prompt": "Выберите, что изменить:",
        "menu_main": "Главное меню",
        "not_implemented": "Эта функция пока недоступна.",
        "btn_log_meal": "Записать приём (заглушка)",
        "btn_photo_meal": "Фото приёма (заглушка)",
        "btn_water": "Вода (заглушка)",
        "btn_weight": "Вес (заглушка)",
        "btn_stats": "Статистика (заглушка)",
        "btn_fridge": "Холодильник (заглушка)",
        "btn_budget": "Бюджет (заглушка)",
        "btn_recipes": "Мои рецепты (заглушка)",
        "btn_ask": "Спросить диетолога (заглушка)",
        "btn_profile": "/profile",
        "sex_m": "Мужской",
        "sex_f": "Женский",
        "sex_other": "Другое",
        "activity_low": "Низкий",
        "activity_medium": "Средний",
        "activity_high": "Высокий",
        "goal_weight_loss": "Похудение",
        "goal_maintenance": "Поддержание",
        "goal_weight_gain": "Набор веса",
        "goal_symptom_control": "Контроль симптомов",
        "invalid_date": "Не получилось прочитать дату, используйте ДД.ММ.ГГГГ или ГГГГ-ММ-ДД",
        "invalid_number": "Пожалуйста, введите корректное число.",
        "skip": "Пропустить",
        "profile_missing": "Профиль не найден. Сначала вызовите /start.",
        "updated": "Обновлено!",
        "menu_log_meal": "Записать приём",
        "menu_photo_meal": "Фото приёма",
        "menu_water": "Вода",
        "menu_weight": "Вес",
        "menu_stats": "Статистика",
        "ask_meal_type": "Выберите тип приёма пищи:",
        "meal_type_breakfast": "Завтрак",
        "meal_type_lunch": "Обед",
        "meal_type_dinner": "Ужин",
        "meal_type_snack": "Перекус",
        "ask_meal_text": "Опишите, что вы съели (в свободной форме).",
        "ask_meal_photo": "Отправьте фото вашего приёма пищи.",
        "ask_meal_photo_optional_text": "При желании добавьте краткое описание.",
        "meal_saved": "Приём сохранён.",
        "meal_photo_received": "Фото получено. Оцениваю калории...",
        "meal_photo_saved": "Приём по фото сохранён.",
        "meal_summary": "Оценка: {calories} ккал (Б {protein} г / Ж {fat} г / У {carbs} г).",
        "meal_photo_summary": "Оценка по фото: {calories} ккал (Б {protein} г / Ж {fat} г / У {carbs} г).",
        "stats_today_title": "Статистика за сегодня:",
        "stats_today_no_meals": "Нет записанных приёмов за сегодня.",
        "stats_today_line": "Итого: {calories} ккал (Б {protein} г / Ж {fat} г / У {carbs} г).",
        "stats_today_macros_title": "Макросы за сегодня:",
        "stats_today_water_line": "Вода: {ml} мл",
        "stats_last_weight_line": "Последний вес: {weight} кг от {date}.",
        "stats_error": "Ошибка при расчёте статистики. Попробуйте позже.",
        "error_no_photo": "Не удалось найти фото в сообщении. Пожалуйста, отправьте снимок блюда.",
        "error_photo_processing": "Ошибка при обработке фото. Попробуйте ещё раз.",
        "ask_water_amount": "Сколько воды вы выпили? (в мл)",
        "water_preset_200": "200 мл",
        "water_preset_250": "250 мл",
        "water_preset_300": "300 мл",
        "water_preset_500": "500 мл",
        "water_other_amount": "Другое количество",
        "water_saved": "Запись воды сохранена.",
        "water_today_total": "Сегодня вы выпили {ml} мл воды.",
        "water_invalid_amount": "Введите корректное количество миллилитров.",
        "ask_weight": "Введите текущий вес в кг (например, 72.5):",
        "weight_saved": "Вес сохранён.",
        "weight_no_previous": "Это первая запись веса.",
        "weight_change_since_last": "Изменение с последнего замера: {delta} кг.",
        "weight_change_vs_goal": "Отклонение от цели: {delta} кг.",
        "weight_invalid": "Введите корректное значение веса в кг.",
        "unknown_command": "Не понимаю эту команду.",
    },
    "pl": {
        "welcome": "Witamy u twojego AI dietetyka! Ustawmy profil.",
        "choose_language": "Wybierz język",
        "language_selected": "Język zapisany: {language}",
        "ask_sex": "Jaka jest twoja płeć?",
        "ask_date_of_birth": "Data urodzenia (DD.MM.RRRR lub RRRR-MM-DD)",
        "ask_height": "Wzrost w cm",
        "ask_weight": "Aktualna waga w kg",
        "ask_goal_weight": "Docelowa waga w kg (lub kliknij Pomiń)",
        "ask_gi_diagnoses": "Diagnozy GI (IBS, GERD itp.) lub 'Brak'",
        "ask_other_diagnoses": "Inne diagnozy lub 'Brak'",
        "ask_medications": "Leki które bierzesz lub 'Brak'",
        "ask_allergies": "Alergie / nietolerancje lub 'Brak'",
        "ask_activity_level": "Poziom aktywności",
        "ask_nutrition_goal": "Główny cel żywieniowy",
        "profile_saved": "Profil zapisany!",
        "profile_title": "Twój profil",
        "profile_field_sex": "Płeć",
        "profile_field_dob": "Data urodzenia",
        "profile_field_height": "Wzrost (cm)",
        "profile_field_weight": "Waga (kg)",
        "profile_field_goal_weight": "Waga docelowa (kg)",
        "profile_field_gi_diagnoses": "Diagnozy GI",
        "profile_field_other_diagnoses": "Inne diagnozy",
        "profile_field_medications": "Leki",
        "profile_field_allergies": "Alergie / nietolerancje",
        "profile_field_activity_level": "Aktywność",
        "profile_field_nutrition_goal": "Cel żywieniowy",
        "profile_edit_prompt": "Wybierz co chcesz edytować:",
        "menu_main": "Menu główne",
        "not_implemented": "Ta funkcja nie jest jeszcze dostępna w tej wersji.",
        "btn_log_meal": "Dodaj posiłek (stub)",
        "btn_photo_meal": "Zdjęcie posiłku (stub)",
        "btn_water": "Woda (stub)",
        "btn_weight": "Waga (stub)",
        "btn_stats": "Statystyki (stub)",
        "btn_fridge": "Lodówka (stub)",
        "btn_budget": "Budżet (stub)",
        "btn_recipes": "Moje przepisy (stub)",
        "btn_ask": "Zapytaj dietetyka (stub)",
        "btn_profile": "/profile",
        "sex_m": "Mężczyzna",
        "sex_f": "Kobieta",
        "sex_other": "Inne",
        "activity_low": "Niski",
        "activity_medium": "Średni",
        "activity_high": "Wysoki",
        "goal_weight_loss": "Redukcja",
        "goal_maintenance": "Utrzymanie",
        "goal_weight_gain": "Przyrost masy",
        "goal_symptom_control": "Kontrola objawów",
        "invalid_date": "Nie rozumiem daty, użyj DD.MM.RRRR lub RRRR-MM-DD",
        "invalid_number": "Podaj poprawną liczbę.",
        "skip": "Pomiń",
        "profile_missing": "Brak profilu. Uruchom /start.",
        "updated": "Zaktualizowano!",
        "menu_log_meal": "Dodaj posiłek",
        "menu_photo_meal": "Zdjęcie posiłku",
        "menu_water": "Woda",
        "menu_weight": "Waga",
        "menu_stats": "Statystyki",
        "ask_meal_type": "Wybierz typ posiłku:",
        "meal_type_breakfast": "Śniadanie",
        "meal_type_lunch": "Obiad",
        "meal_type_dinner": "Kolacja",
        "meal_type_snack": "Przekąska",
        "ask_meal_text": "Opisz co zjadłeś (dowolny tekst).",
        "ask_meal_photo": "Wyślij zdjęcie swojego posiłku.",
        "ask_meal_photo_optional_text": "Możesz też dodać krótki opis.",
        "meal_saved": "Posiłek zapisany.",
        "meal_photo_received": "Zdjęcie otrzymane. Szacuję kalorie...",
        "meal_photo_saved": "Posiłek ze zdjęcia zapisany.",
        "meal_summary": "Szacunkowo: {calories} kcal (B {protein} g / T {fat} g / W {carbs} g).",
        "meal_photo_summary": "Szacunek ze zdjęcia: {calories} kcal (B {protein} g / T {fat} g / W {carbs} g).",
        "stats_today_title": "Statystyki na dziś:",
        "stats_today_no_meals": "Brak zapisanych posiłków dziś.",
        "stats_today_line": "Suma: {calories} kcal (B {protein} g / T {fat} g / W {carbs} g).",
        "stats_today_macros_title": "Makro na dziś:",
        "stats_today_water_line": "Woda: {ml} ml",
        "stats_last_weight_line": "Ostatnia waga: {weight} kg z dnia {date}.",
        "stats_error": "Błąd podczas liczenia statystyk. Spróbuj ponownie później.",
        "error_no_photo": "Nie znalazłem zdjęcia w wiadomości. Wyślij proszę zdjęcie posiłku.",
        "error_photo_processing": "Błąd podczas przetwarzania zdjęcia. Spróbuj ponownie.",
        "ask_water_amount": "Ile wody wypiłeś? (w ml)",
        "water_preset_200": "200 ml",
        "water_preset_250": "250 ml",
        "water_preset_300": "300 ml",
        "water_preset_500": "500 ml",
        "water_other_amount": "Inna ilość",
        "water_saved": "Woda zapisana.",
        "water_today_total": "Dziś wypiłeś {ml} ml wody.",
        "water_invalid_amount": "Podaj poprawną ilość w mililitrach.",
        "ask_weight": "Podaj swoją obecną wagę w kg (np. 72.5):",
        "weight_saved": "Waga zapisana.",
        "weight_no_previous": "To pierwszy zapis twojej wagi.",
        "weight_change_since_last": "Zmiana od ostatniego pomiaru: {delta} kg.",
        "weight_change_vs_goal": "Różnica względem celu: {delta} kg.",
        "weight_invalid": "Podaj poprawną wagę w kg.",
        "unknown_command": "Nie rozumiem tej komendy.",
    },
}


SUPPORTED_LANGUAGES = ("en", "ru", "pl")


def t(lang: str, key: str, **kwargs: Any) -> str:
    lang_map = translations.get(lang) or translations["en"]
    template = lang_map.get(key) or translations["en"].get(key, key)
    return template.format(**kwargs)
